<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>OlddrobloxCorp</title>
  <link rel="icon" href="favicon.png" type="image/png">
  <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&display=swap" rel="stylesheet">
  <style>
    html, body {
      margin: 0;
      padding: 0;
      width: 100%;
      height: 100%;
      overflow: hidden; /* no scrollbars */
      font-family: 'Roboto', Arial, sans-serif;
      background: black;
    }

    /* Game container locked in place */
    #game_frame {
      position: fixed;
      top: 0;
      left: 0;
      width: 100vw;
      height: 100vh;
      background: black;
      overflow: hidden;
      z-index: 1; /* behind loader */
    }

    /* Loader overlay */
    #loader-container {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0,0,0,1); /* fully solid black */
      display: flex;
      justify-content: center;
      align-items: center;
      z-index: 9999;
      transition: opacity 0.8s ease;
    }

    #loader-container.fade-out {
      opacity: 0;
      pointer-events: none;
    }

    /* Loader animation */
    .loader {
      width: 175px;
      height: 80px;
      display: block;
      margin:auto;
      background-image: radial-gradient(circle 25px at 25px 25px, #FFF 100%, transparent 0), 
                        radial-gradient(circle 50px at 50px 50px, #FFF 100%, transparent 0), 
                        radial-gradient(circle 25px at 25px 25px, #FFF 100%, transparent 0), 
                        linear-gradient(#FFF 50px, transparent 0);
      background-size: 50px 50px, 100px 76px, 50px 50px, 120px 40px;
      background-position: 0px 30px, 37px 0px, 122px 30px, 25px 40px;
      background-repeat: no-repeat;
      position: relative;
      box-sizing: border-box;
    }

    .loader::before {
      content: '';  
      left: 60px;
      bottom: 18px;
      position: absolute;
      width: 36px;
      height: 36px;
      border-radius: 50%;
      background-color: #FF3D00;
      background-image: radial-gradient(circle 8px at 18px 18px, #FFF 100%, transparent 0),
                        radial-gradient(circle 4px at 18px 0px, #FFF 100%, transparent 0),
                        radial-gradient(circle 4px at 0px 18px, #FFF 100%, transparent 0),
                        radial-gradient(circle 4px at 36px 18px, #FFF 100%, transparent 0),
                        radial-gradient(circle 4px at 18px 36px, #FFF 100%, transparent 0),
                        radial-gradient(circle 4px at 30px 5px, #FFF 100%, transparent 0),
                        radial-gradient(circle 4px at 30px 5px, #FFF 100%, transparent 0),
                        radial-gradient(circle 4px at 30px 30px, #FFF 100%, transparent 0),
                        radial-gradient(circle 4px at 5px 30px, #FFF 100%, transparent 0),
                        radial-gradient(circle 4px at 5px 5px, #FFF 100%, transparent 0);
      background-repeat: no-repeat;
      box-sizing: border-box;
      animation: rotationBack 3s linear infinite;
    }

    .loader::after {
      content: '';  
      left: 94px;
      bottom: 15px;
      position: absolute;
      width: 24px;
      height: 24px;
      border-radius: 50%;
      background-color: #FF3D00;
      background-image: radial-gradient(circle 5px at 12px 12px, #FFF 100%, transparent 0),
                        radial-gradient(circle 2.5px at 12px 0px, #FFF 100%, transparent 0),
                        radial-gradient(circle 2.5px at 0px 12px, #FFF 100%, transparent 0),
                        radial-gradient(circle 2.5px at 24px 12px, #FFF 100%, transparent 0),
                        radial-gradient(circle 2.5px at 12px 24px, #FFF 100%, transparent 0),
                        radial-gradient(circle 2.5px at 20px 3px, #FFF 100%, transparent 0),
                        radial-gradient(circle 2.5px at 20px 3px, #FFF 100%, transparent 0),
                        radial-gradient(circle 2.5px at 20px 20px, #FFF 100%, transparent 0),
                        radial-gradient(circle 2.5px at 3px 20px, #FFF 100%, transparent 0),
                        radial-gradient(circle 2.5px at 3px 3px, #FFF 100%, transparent 0);
      background-repeat: no-repeat;
      box-sizing: border-box;
      animation: rotationBack 4s linear infinite reverse;
    }

    @keyframes rotationBack {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(-360deg); }
    }
  </style>
</head>
<body>
  <!-- Loader -->
  <div id="loader-container">
    <span class="loader"></span>
  </div>

  <!-- Game container -->
  <div id="game_frame"></div>

  <!-- Firebase + Game scripts -->
  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-app.js";
    import { getAuth, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-auth.js";

    const firebaseConfig = {
      apiKey: "AIzaSyAuKVVUBWNDNgtDPwAdEqaZNabwfXyKmRw",
      authDomain: "oldrobloxcorpsinginadmin.firebaseapp.com",
      projectId: "oldrobloxcorpsinginadmin",
      storageBucket: "oldrobloxcorpsinginadmin.appspot.com",
      messagingSenderId: "1038903313808",
      appId: "1:1038903313808:web:e86fd0d6af963648045f15"
    };

    const app = initializeApp(firebaseConfig);
    const auth = getAuth(app);

    function hideLoader() {
      const loader = document.getElementById("loader-container");
      loader.classList.add("fade-out");
      setTimeout(() => loader.remove(), 1000);
    }

    onAuthStateChanged(auth, (user) => {
      if (user) {
        console.log("✅ Logged in as:", user.email);

        // Wait for game to initialize before hiding loader
        window.addEventListener("eaglercraft-ready", () => {
          hideLoader();
        });
      } else {
        console.log("❌ Not logged in, redirecting...");
        window.location.href = "login.html";
      }
    });
  </script>

  <!-- EaglercraftX -->
  <script src="https://file.garden/aKSb64_ekUpfn5I8/1.9/classes.js"></script>
  <script>
    window.addEventListener("load", () => {
      var relayId = Math.floor(Math.random() * 3);
      window.eaglercraftXOpts = {
        demoMode: false,
        container: "game_frame",
        assetsURI: "https://file.garden/aKSb64_ekUpfn5I8/1.9/assets.epk",
        localesURI: "lang/",
        worldsDB: "worlds",
        servers: [
          	{ addr: "wss://arch.mc", name: "ArchMC" },
			{ addr: "wss://mc.time-legacy.net", name: "TimeLegacy"},
			{ addr: "wss://play.ragexwaternet.online", name: "Water Network"},
			{ addr: "wss://nexo-app.net", name: "NEXO" },
			{ addr: "wss://vanillamc.org", name: "VanillaMC Legacy" },
			{ addr: "wss://clever-teaching.com", name: "Clever Teaching" },
			{ addr: "wss://ggsmp.net", name: "GG SMP"}
			/* example: { addr: "ws://localhost:8081/", name: "Local test server" } */
        ],
        relays: [
          { addr: "wss://relay.deev.is/", name: "Deev Relay" },
          { addr: "wss://relay.lax1dude.net/", name: "LAX1 Relay" },
          { addr: "wss://relay.shhnowisnottheti.me/", name: "Shhnow Relay" }
        ]
      };

      main();

      // Fake event to signal "game is ready" after small delay
      setTimeout(() => {
        window.dispatchEvent(new Event("eaglercraft-ready"));
      }, 3000); // adjust if needed
    });
  </script>
</body>
</html>