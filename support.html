<!DOCTYPE html>
<html lang="en">
<head>
  <title>Oldroblox Support</title>
  <link rel="icon" href="favicon.png" type="image/png">
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <!-- W3.CSS and fonts -->
  <link rel="stylesheet" href="https://www.w3schools.com/w3css/4/w3.css">
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Lato">
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Montserrat">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">

  <style>
    body,h1,h2,h3,h4,h5,h6 {font-family: "Lato", sans-serif;}
    .w3-bar,h1,button {font-family: "Montserrat", sans-serif;}
    input,textarea {width:100%;padding:12px;margin:6px 0;border:1px solid #ccc;border-radius:4px;}
    button {background-color:#f44336;color:white;padding:12px 20px;border:none;border-radius:4px;cursor:pointer;}
    button:hover {background-color:#d32f2f;}
    .msg {margin-top:10px;display:none;}
    .msg.ok {color:green;}
    .msg.err {color:red;}
  </style>
</head>
<body>

<!-- Navbar -->
<div class="w3-top">
  <div class="w3-bar w3-red w3-card w3-left-align w3-large">
    <a href="/" class="w3-bar-item w3-button w3-padding-large w3-white">Home</a>
    <a href="chat/index" class="w3-bar-item w3-button w3-hide-small w3-padding-large w3-hover-white">Chat</a>
    <a href="https://youtube.com/@oldrobloxcorp" class="w3-bar-item w3-button w3-hide-small w3-padding-large w3-hover-white">Youtube</a>
    <a href="tos?" class="w3-bar-item w3-button w3-hide-small w3-padding-large w3-hover-white">Terms of service</a>
  </div>
</div>

<!-- Page header -->
<header class="w3-container w3-red w3-center" style="padding:128px 16px">
  <h1 class="w3-margin w3-jumbo">Oldroblox Support</h1>
  <p class="w3-xlarge">Submit a support ticket and weâ€™ll email you a confirmation.</p>
</header>

<!-- Support Form -->
<div class="w3-row-padding w3-padding-64 w3-container">
  <div class="w3-content w3-half">
    <h2>Contact Support</h2>
    <form id="supportForm">
      <label>Name</label>
      <input type="text" name="name" required>
      <label>Email</label>
      <input type="email" name="email" required>
      <label>Message</label>
      <textarea name="message" rows="6" required></textarea>
      <button type="submit">Submit Ticket</button>
      <p id="ok" class="msg ok">Your ticket was sent successfully!</p>
      <p id="err" class="msg err">Failed to send ticket. Check console for details.</p>
    </form>
  </div>
</div>

<script>
  // ðŸ”´ Set your Vercel backend API URL
  const API_URL = "https://oldroblox-support-backend.vercel.app/api";

  const form = document.getElementById("supportForm");
  const okMsg = document.getElementById("ok");
  const errMsg = document.getElementById("err");

  form.addEventListener("submit", async (e) => {
    e.preventDefault();
    okMsg.style.display = "none";
    errMsg.style.display = "none";

    const payload = {
      name: form.name.value.trim(),
      email: form.email.value.trim(),
      message: form.message.value.trim()
    };

    try {
      const res = await fetch(API_URL, {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify(payload)
      });

      if (!res.ok) {
        const text = await res.text();
        console.error("HTTP error", res.status, text);
        throw new Error(`HTTP ${res.status}`);
      }

      const data = await res.json();
      if (data && data.success) {
        okMsg.style.display = "block";
        form.reset();
      } else {
        console.error("API returned:", data);
        errMsg.style.display = "block";
      }
    } catch (err) {
      console.error("Fetch failed:", err);
      errMsg.style.display = "block";
    }
  });
</script>

</body>
</html>
